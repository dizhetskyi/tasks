<div class="container">

  <div class="clearfix">
    <h3 class="pull-left">Tasks list</h3>
    <div class="pull-right">
      <br>
      <a href="#/newTask" class="btn btn-success btn-sm">
        <i class="fa fa-plus"></i> Add task
      </a>
    </div>
  </div>

  <br>

  <div ng-if="vm.loading" class="text-center">
    <i class="fa fa-spin fa-spinner fa-2x"></i>
  </div>

  <div ng-if="!vm.loading">

    <div class="clearfix">

      <nav ng-show="vm.pagination.pages > 1">
        <ul class="pagination">
          <li ng-repeat="a in vm.range(vm.pagination.pages) track by $index" ng-class="{active: $index === vm.pagination.page - 1}" >
            <a href="" ng-click="vm.setPaginationPage($index + 1)">{{$index + 1}}</a>
          </li>
        </ul>
      </nav>

    </div>

    <input type="text" class="form-control input-lg" ng-model="vm.search.title" placeholder="search by title">
    <br>

    <div ng-if="vm.search.tags">
      Filter by tag: <a href="" class="btn btn-default" ng-click="vm.search.tags = undefined">{{vm.search.tags}} <i class="fa fa-remove text-danger"></i></a>
    </div>

    <div>
      <!-- Сложность: &nbsp; -->
      <!-- <span class="checkbox" style="display: inline-block;"><label><input type="checkbox" ng-model="vm.maxLevel">Не меньше</label></span> -->
      <span class="star-cb-group">
        <input type="radio" id="rating-5" name="rating" ng-model="vm.search.level" value="5" /><label for="rating-5">5</label>
        <input type="radio" id="rating-4" name="rating" ng-model="vm.search.level" value="4" checked="checked" /><label for="rating-4">4</label>
        <input type="radio" id="rating-3" name="rating" ng-model="vm.search.level" value="3" /><label for="rating-3">3</label>
        <input type="radio" id="rating-2" name="rating" ng-model="vm.search.level" value="2" /><label for="rating-2">2</label>
        <input type="radio" id="rating-1" name="rating" ng-model="vm.search.level" value="1" /><label for="rating-1">1</label>
        <input type="radio" id="rating-0" name="rating" value="0" class="star-cb-clear" /><label for="rating-0">0</label>
      </span>

      <a href="" class="btn btn-default" ng-click="vm.search.level = undefined"><i class="fa fa-remove text-danger"></i></a>

    </div>

    <div ng-show="vm.visibleTasks() === 0">No results</div>

    <table class="table" ng-show="vm.visibleTasks() > 0">
      <thead>
        <tr>
          <th>
            <a ng-click="vm.changeOrder('title')" href="">Title</a>
            <i class="fa" ng-class="{
              'fa-sort-amount-desc': vm.orderProp === 'title' && vm.orderReversed,
              'fa-sort-amount-asc': vm.orderProp === 'title' && !vm.orderReversed
            }"></i>
          </th>
          <th>
            <a ng-click="vm.changeOrder('level')" href="">Level</a>
            <i class="fa" ng-class="{
              'fa-sort-amount-desc': vm.orderProp === 'level' && vm.orderReversed,
              'fa-sort-amount-asc': vm.orderProp === 'level' && !vm.orderReversed
            }"></i>
          </th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tr ng-repeat="task in vm.tasks | filter : vm.search | orderBy : vm.orderProp : vm.orderReversed | limitTo : vm.pagination.perPage : (vm.pagination.page - 1) * vm.pagination.perPage track by $index">
        <td style="font-size: 16px;">
          <a ng-href="#/task/{{task.slug}}">{{task.title}}</a>
        </td>
        <td>
          <span data-toggle="tooltip" title="{{vm.levelLabel[task.level]}}" tooltip>
            <i class="fa fa-star" ng-repeat="i in vm.range(task.level) track by $index"></i>
          </span>
        </td>
        <td>
            <a href="" ng-repeat="tag in task.tags" ng-click="vm.setTagFilter(tag)">{{tag}}</a>
        </td>
        <td>
          <a class="btn btn-default btn-xs" ng-if="task.repository_link" href="{{task.repository_link}}" target="_blank" title="{{task.repository_link}}" tooltip><i class="fa fa-github fa-2x"></i></a>
        </td>
        <td class="text-right">
          <a class="btn btn-xs btn-info" ng-href="#/task/{{task.slug}}/edit"><i class="fa fa-pencil"></i> Update</a>
          &nbsp;
          <a class="btn btn-xs btn-danger" ng-click="vm.removeTask($event, task._id)"><i class="fa fa-remove"></i> Remove</a>
        </td>
      </tr>
    </table>

  </div>
</div>
